function clearTextFields(){$("textarea").each(function(e){$(this).val("")}),$("[type=text]").each(function(e){$(this).val("")})}function clearInputFields(){$("[type=input]").each(function(e){$(this).val("")})}function clearOutputFields(){showStatusMessages&&clearStatusMessages(),$(".output_value").val("");var e=document.getElementById("tableOutput");if(null!=e)for(var t=e.rows.length-1;t>0;t--)e.deleteRow(t)}function getInputFieldsAsQueryString(){var e=new Array;if(useSessionStorage){saveUserData();for(var t=0;t<sessionStorage.length;t++){var n=sessionStorage.key(t),o=sessionStorage.getItem(n);n.indexOf("ls.")===-1&&n.indexOf("serviceManagerLocalStorage.")===-1&&e.push(n+"="+(null===o?"":o))}}else for(var a=0;a<inputElementsArray.length;a++){var r=inputElementsArray[a].id;if(null!=r&&0!=r.length){var i=encodeURIComponent(inputElementsArray[a].value);e.push(r+"="+(i.length>0?i:"null"))}}return e.join("&")}function _populateCheckboxHTML(e,t){e.checked=""+t=="true",e.previousSibling.className=e.previousSibling.className.replace("ui-checkbox-on","").replace("ui-checkbox-off",""),e.previousSibling.className+=e.checked?"ui-checkbox-on":"ui-checkbox-off"}function _applyConverterFunction(e,t){var n=window["convert_"+e];return"function"==typeof n?n(t):t}function _populateFieldCommon(e,t){try{var n=e.nodeName;"INPUT"===n?"checkbox"===e.type?_populateCheckboxHTML(e,t):e.value=t:"TEXTAREA"===n?e.value=t:"DIV"===n||"LABEL"===n?e.innerHTML=t:"A"===n&&(0===e.href.indexOf("tel:")?(e.innerHTML=t,e.href="tel:"+t):(e.innerHTML=_applyConverterFunction(e.id,t),e.href=e.innerHTML))}catch(o){}}function populateField(e,t,n){var o;if("undefined"!=typeof n&&(o=document.getElementById(e+n)),"undefined"!=typeof o&&null!=o||(o=document.getElementById(e)),"undefined"==typeof o||null==o){if(useSessionStorage&&"undefined"!=typeof t)return sessionStorage.setItem(e,t),void sessionStorage.setItem(e+n,t);o=addHiddenField(e)}"undefined"!=typeof t&&_populateFieldCommon(o,t);try{if(useSessionStorage)sessionStorage.setItem(e,t);else{var a=inputElementsArray.indexOf(o);a<0&&inputElementsArray.push(o)}}catch(r){}}function populateFieldHTML(e,t,n){var o;void 0!=n&&(o=document.getElementById(e+n)),void 0==o&&(o=document.getElementById(e)),void 0!=o&&null!=o&&_populateFieldCommon(o,t)}function setDefaultValues(){if(void 0!==defaultValues)for(var e in defaultValues)if(null===getSessionFieldValue(e,!1)){var t=defaultValues[e];try{var n=$("#"+e);"checkbox"===t.type?n.attr("checked",t.value).checkboxradio("refresh"):"slider"===t.type?n.val(t.value).flipswitch("refresh"):"date"===t.type?(n.datepicker(),n.datepicker("option","dateFormat",t.value.format),n.datepicker().datepicker("setDate",t.value.dateValue)):populateFieldHTML(e,t.value)}catch(o){}}}function setUserDataValuesInFields(){if(useSessionStorage)for(var e=0;e<sessionStorage.length;e++){var t=sessionStorage.key(e),n=sessionStorage.getItem(t);populateFieldHTML(t,"null"===n?"":n,"_output")}else for(var e in data)populateField(e,decodeURIComponent(data[e]))}function getInputFieldsAsJson(){"use strict";for(var e='{"data":{',t=0;t<inputElementsArray.length;t++){var n=inputElementsArray[t],o=n.id;if(null!==o&&0!==o.length){var a="checkbox"===n.type?n.checked:n.value;e+='"'+o+'":"'+a+'",'}}return e+='"":""}}'}function getFieldValue(e){var t,n=$("#"+e);return n.length>0&&(t=n.is("input")?"checkbox"===n[0].type?n[0].checked:n.val():n.text()),void 0==t&&useSessionStorage?getSessionFieldValue(e):cleanValue(t)}function refreshInputElements(){useSessionStorage||(inputElementsArray=collectInputElements())}function addHiddenField(e,t){var n=document.getElementById(e);if(null==n){var o=$("<input>").attr({type:"hidden",id:e});return void 0!=t&&(o.value=t),o.appendTo("body"),refreshInputElements(),o[0]}}function removeDuplicatedFields(){var e=$(".requestField input").filter(function(e,t){return $(".responseField #"+t.id).length>0});$(e).each(function(e,t){$(".responseField  #"+t.id).closest(".responseField ").remove()}),refreshInputElements()}function collectInputElements(){for(var e=new Array,t=document.getElementsByTagName("input"),n=["submit","button","file"],o=0;o<t.length;o++)n.indexOf(t[o].type)==-1&&e.push(t[o]);for(var a=document.getElementsByTagName("select"),o=0;o<a.length;o++)e.push(a[o]);return e}function setNodeValue(e,t){void 0!=e&&(e.textContent=t)}function getNodeValue(e){return void 0==e?"Undefined":(value=e.textContent,void 0==value&&(value=e.text),value)}function getResponseNodeValueByName(e,t){return null==window.response&&null==t?"":("undefined"!=typeof t&&null!=t||(t=window.response),findValues(t,e)[0]||"")}function setResponseNodeValueByName(e,t){return null==window.response?"":setValues(window.response,e,t)}function getResponseNodeListValueByName(e){return null==window.response?"":findValues(window.response,e)}function populateStatusMessages(e,t,n){n.length>0&&0==e.length&&0==t.length&&(e=n,t=n),null!=$("#StatusBarMessages")&&populateField("StatusBarMessages",e),null!=$("#PopupMessages")&&populateField("PopupMessages",t)}function clearStatusMessages(){null!=$("#StatusBarMessages")&&$("#StatusBarMessages").text(""),null!=$("#PopupMessages")&&$("#PopupMessages").text("")}function validateRequiredFields(){void 0!==$("#responseForm")[0]&&($("#responseForm")[0].checkValidity()?$("button").prop("disabled",!1):$("button").prop("disabled","disabled"))}function getURLParameters(e){var t={},n=e.indexOf("?");if(n==-1)return t;for(var o=e.substring(n+1),a=o.split("&"),r=0;r<a.length;r++){var i=a[r].split("=");t[i[0]]=i[1]}return t}function getNameWoIndexLength(e){return e.indexOf("_")!==-1?e.lastIndexOf("_"):e.length}function uploadNewFiles(){spinner().start("Uploading attachments..");var e=$.Deferred(),t=[];return $('input[type="file"]').each(function(e,n){if(void 0!==n.attributes.uploaded&&"true"!==n.attributes.uploaded.value&&(store(n.id,""),0!==n.files.length||void 0!==n.attributes.fileFromCamera)){var o=void 0!==n.attributes.fileFromCamera?dataURItoBlob(n.attributes.fileFromCamera.value):n.files[0],a=void 0!==n.attributes["data-target"]?n.attributes["data-target"].value:"",r=new FormData;r.append("path",""!==a?a:"www/upload"),r.append("file",o),""!==a&&r.append("absolute",!0),t.push($.ajax({url:getServiceManagerHost()+"/ServiceManager/Macro/FileManager",data:r,type:"POST",contentType:!1,processData:!1,success:function(e){store(n.id,e.data),n.setAttribute("uploaded",!0)},error:function(e,t,n){spinner().stop(),showInfoPopup("File upload failed",n)}}))}}),$.when.all(t).then(function(t){spinner().stop(),e.resolve()}),e.promise()}function dataURItoBlob(e){for(var t=atob(e.split(",")[1]),n=new ArrayBuffer(t.length),o=new Uint8Array(n),a=0;a<t.length;a++)o[a]=t.charCodeAt(a);return new Blob([n],{type:"image/jpeg"})}function getLocation(e){var t={enableHighAccuracy:!0,timeout:5e3,maximumAge:0},n=populatePosition.bind(this,e);navigator.geolocation?navigator.geolocation.getCurrentPosition(n,null,t):(msg="Geolocation is not supported by this browser.",alert(msg))}function populatePosition(e,t){var n="http://maps.googleapis.com/maps/api/geocode/json?latlng="+t.coords.latitude+","+t.coords.longitude+"&language=en&sensor=false";jQuery.getJSON(n,function(t){var n={};$.each(t.results[0].address_components,function(e,t){n[t.types[0]]=t.long_name}),e(n)})}function executeHandler(e){void 0!=e&&(void 0!=e.preFunction&&executeCallFunctionHandler(e.preFunction,arguments),/function$/.test(e.action)?executeCallFunctionHandler(e.attr,arguments):/webservice$/.test(e.action)||"onload"==e.action?callWebServiceWithAllParams(e.attr,e.initHandler,e.responseHandler,e.failureHandler,!0,!0):/navigate$/.test(e.action)&&navigate(e.attr))}function executeCallFunctionHandler(e,t){void 0==window[e]?alert("Undefined function: "+e):window[e].apply(void 0,arguments.length>1?Array.prototype.slice.call(t,1):void 0)}function analyzeJson(e,t,n,o){if("undefined"==typeof e.Response)return void executeResponseHandler(t,e,n);var a=e.Response[n+"Message"].Error,r=e.Response[n+"Message"].PopupMessages,i=e.Response[n+"Message"].StatusBarMessages;showStatusMessages&&populateStatusMessages(i,r,a);var s=e.Response[n+"Elements"];if("object"==typeof s&&null!==s){var l="",u="";for(var c in s)u=c,l=s[c],useSessionStorage===!1&&(data[u]=l),("undefined"==typeof o||o)&&populateField(u,l,"_output")}var d=null;return"undefined"!=typeof e.Response[n+"TableArray"]&&(d=[].concat(e.Response[n+"TableArray"][n+"ArrayItem"])),storeArrayInSessionStorage(d),("undefined"==typeof o||o)&&(setUserDataValuesInFields(),(hasTable||hasList)&&populateTableOrList()),executeResponseHandler(t,e,n,d),!0}function executeResponseHandler(e,t,n,o){if("undefined"!=typeof e&&""!==e){if("undefined"==typeof e.indexOf||e.indexOf(":")===-1)return void(("undefined"!=typeof e||"undefined"!=typeof window[e]&&null!==window[e])&&("function"==typeof window[e]?window[e].call(this,t,n,o):"function"==typeof e&&e.call(this,t,n,o)));if(/^popupErrors:/.test(e)){var a=e.substring(12),r=a.lastIndexOf(";");return void showServiceErrorsPopup(a.substring(0,r),a.substring(r+1))}if(/^popupAndNavigate:/.test(e)){var r=e.lastIndexOf(":"),i=e.substring(17,r),s=e.substring(r+1);return void showInfoPopup("",i,function(){navigate(s)})}if(/^popup:/.test(e)){var i=e.substring(6);return void showInfoPopup("",i)}if(/^navigate:/.test(e)){var s=e.substring(9);return void navigate(s)}}}function _callWebServiceWithAllParams(e,t,n,o,a,r){var i=getInputFieldsAsQueryString();callWebService(e,i,t,n,o,a,r)}function callWebServiceWithAllParams(e,t,n,o,a,r){"function"==typeof window.uploadNewFiles?uploadNewFiles().then(function(){_callWebServiceWithAllParams(e,t,n,o,a,r)}):_callWebServiceWithAllParams(e,t,n,o,a,r)}function callWebService(e,t,n,o,a,r,i){if(!waitingForResponse&&(e=e.trim(),"undefined"!=typeof e&&""!==e)){var s;s=e.indexOf("/")===-1&&e.indexOf(".")===-1&&e.indexOf(":")===-1?"/ServiceManager/Macro/ExecMacro/"+e:e;var l=encodeURI(t)+"&randomSeed="+1e6*Math.random()+"&userDataId="+userDataId+"&json=true",u=s.substr(s.lastIndexOf("/")+1);if("undefined"!=typeof n&&"undefined"!=typeof window[n]&&null!==window[n]){if("function"==typeof window[n])var c=window[n].call(this,u);if(c===!1)return}$(document).triggerHandler("sendRequest"),waitingForResponse=!0,sendWebServiceRequest(u,getServiceManagerHost()+s,l,r,o,a,i)}}function sendWebServiceRequest(e,t,n,o,a,r,i){$.ajax({url:t,type:"POST",timeout:WEB_SERVICE_TIMEOUT,dataType:"json",data:n,async:"undefined"==typeof o||o,success:function(t){"function"==typeof storeOfflineResponseIfNeeded&&storeOfflineResponseIfNeeded(e,t),onWebServiceAjaxSuccess(t,a,r,e,i)},error:function(o,a,s){0===o.status?(spinner().stop(),invokeOfflineHandler(e,t,n)):onWebServiceAjaxFailure(o,a,r,e,i)},complete:function(){waitingForResponse=!1}})}function populateErrorsToHandler(e,t,n){return"function"!=typeof e&&/^popupErrors:/.test(e)?e+t+";"+n:e}function onWebServiceAjaxSuccess(e,t,n,o,a){window.response=e;var r=getResponseNodeValueByName("Error");"Service is disabled."==r?(showInfoPopup("Service Error",r),executeResponseHandler(n,void 0,o,void 0),$(document).triggerHandler("receiveResponse",[null,o,"error",a])):"undefined"!=typeof r&&null!==r&&""!==r?(n=populateErrorsToHandler(n,r,200),analyzeJson(e,n,o,a),$(document).triggerHandler("receiveResponse",[null,o,"error",a])):(analyzeJson(e,t,o,a),$(document).triggerHandler("receiveResponse",[e,o,"success",a]))}function populateErrorsToHandler(e,t,n){return"function"!=typeof e&&/^popupErrors:/.test(e)?e+t+";"+n:e}function onWebServiceAjaxFailure(e,t,n,o,a){var r=getResponseNodeValueByName("Error",e.responseJSON);"undefined"==typeof r||null==r||""===r?(404===e.status?showInfoPopup("Service Error","Service has failed with status of 404 - Requested page not found"):500===e.status?showInfoPopup("Service Error","Service has failed with status of 500 - Internal Server Error"):"parsererror"===t?showInfoPopup("Service Error","Requested url parse failed"):"timeout"===t?showInfoPopup("Service Error","Timeout reached, no response"):"abort"===t?showInfoPopup("Service Error","Ajax request aborted"):showInfoPopup("Service Error","Unexpected Error: \n"+e.responseText),/^popupErrors:/.test(n)||executeResponseHandler(n,void 0,o,void 0)):"undefined"!=typeof r&&null!=r&&""!==r&&(n=populateErrorsToHandler(n,r,e.status),analyzeJson(e.responseJSON,n,o,a)),$(document).triggerHandler("receiveResponse",[null,o,"error",a])}function getHandlersByFilter(e,t){return void 0==e?[]:$(e).filter(function(e,n){return objFilter(n,t)})}function fetchService(e,t,n){var o;e=e.trim(),"undefined"!=typeof e&&""!==e&&(o="/ServiceManager/Macro/Service/"+e,$.ajax({url:getServiceManagerHost()+o,type:"GET",timeout:WEB_SERVICE_TIMEOUT,dataType:"json",async:!0,success:t,error:n}))}function showServiceErrorsPopup(e,t){var n="<div> Service failed with errors [status "+t+"]:<br />&#9658;";n+=[].concat.apply([],e.split("'").map(function(e,t){return t%2?"'"+e+"'":e.split(";").join("<br />&#9658;")})).filter(Boolean).join(""),n+="<div/>",showInfoPopup("Service Error",n)}function objFilter(e,t){var n=!0;for(key in t)n&=e[key]==t[key];return n}function getServiceManagerHost(){return"undefined"!=typeof app&&void 0!=app.serviceManagerHost&&null!=app.serviceManagerHost?app.serviceManagerHost.trim().replace(/\/$/,""):""}function navigate(e){saveUserData(),window.location=e}function initData(){if(userDataId=docCookies.getItem("userDataId"),useSessionStorage)setUserDataValuesInFields(),initTableOrListFlags(),populateTableOrList(),addTableOrListClickListener();else if(null!=userDataId)refreshInputElements(),getUserDataFromServer();else{userDataId=Math.ceil(1e7*Math.random()),data=new Object;var e=new Date;e.setSeconds(e.getSeconds()+cookieLifespan),docCookies.setItem("userDataId",userDataId,e)}var t=getURLParameters(window.location.search);for(param in t)populateField(param,t[param]);initEventHandlers(),"object"==typeof window.handlerMap?executeOnLoadHandlers():loadHandlersWithAjax()}function loadHandlersWithAjax(){var e=$('meta[name="Creation-Timestamp"]').attr("content");void 0==e&&alert("Error: Meta tag Creation-Timestamp is missing");var t="handlerMap_"+e+".json";$.ajax({url:"json/"+t,dataType:"text",timeout:WEB_SERVICE_TIMEOUT,success:function(e){/^handlerMap=/.test(e)&&(e=e.substring("handlerMap=".length,e.length-";".length)),handlerMap=JSON.parse(e),executeOnLoadHandlers()},error:function(){alert("Error loading handler map "+t)}})}function executeOnLoadHandlers(){var e=[];$.merge(e,getHandlersByFilter(handlerMap,{action:"onload"})),$.merge(e,getHandlersByFilter(handlerMap,{action:"onload:navigate"})),$.merge(e,getHandlersByFilter(handlerMap,{action:"onload:function"}));for(var t=0;t<e.length;t++)executeHandler(e[t]);$(document).triggerHandler("pageInitialized")}function initEventHandlers(){$(document).on("sendRequest",function(){void 0!=window.sendRequestHandler&&window.sendRequestHandler.call(this)}),$(document).on("receiveResponse",function(e,t,n,o,a){void 0!=window.receiveResponseHandler&&window.receiveResponseHandler.call(this,t,n,o,a)}),$(document).on("pageInitialized",function(){void 0!=window.pageInitializedHandler&&window.pageInitializedHandler.call(this)})}function createList(e,t,n){var o=getInputFieldsAsQueryString(),a="/ServiceManager/Macro/ExecMacro/"+e+"?"+o+"&json=true";jQuery.getJSON(encodeURI(a),function(o){populateList(o,e,t,n)})}function populateList(e,t,n,o){var a=null;void 0!=e.Response[t+"TableArray"]&&(a=[].concat(e.Response[t+"TableArray"][t+"ArrayItem"])),populateListItems(a,n,o)}function populateListItems(e,t,n){if(null==n&&(n=defaultListSelectionHandler),null==t&&(t=defaultTitleGenerator),$("#listMenu").popup(),$("#listItems").find(".lovItem").remove(),$("#listMenu").off("click","li"),null!=e&&isArray(e))for(var o=0;o<e.length;o++){var a=$("<li/>");a.addClass("lovItem");for(var r in e[o]){var i=r,s=e[o][r];a.data(i,s)}var l=$("<a/>");if(l.attr("href","#"),l.addClass("ui-btn"),l.addClass("ui-btn-icon-right"),l.addClass("ui-icon-carat-r"),isFunction(t)){var u=t.call(this,a.data(),o);l.text(u)}else l.text(a.data(String(t)));a.append(l),$("#listItems").append(a)}$("#listMenu").on("click","li",function(){$("#listMenu").popup("close"),n.call(this,$(this).data())}),$("#listMenu").popup(),$("#listMenu").popup("open")}function defaultTitleGenerator(e,t){return t+1+") "+e[Object.keys(e)[0]]}function defaultListSelectionHandler(e){for(inputId in e){var t=e[inputId];populateFieldHTML(inputId,t)}}function createSelectObject(e){var t=document.getElementById(e);if(t.type.indexOf("select")<0){var n=document.createElement("select");n.id=e;var o=t.parentNode;if(o.className.indexOf("ui-input-text")>-1){var a=t.parentNode;t.parentNode.parentNode.replaceChild(n,a)}else t.parentNode.replaceChild(n,t);t.id=e,t=n}for(selectLength=t.length,i=0;i<selectLength;i++)t.remove(0);return t}function populateSelectItems(e,t){var n=createSelectObject(t);if(null!=e&&isArray(e)&&void 0!=e[0]){keyName=Object.keys(e[0]);for(var o=0;o<e.length;o++){var a=e[o][keyName].split(","),r=document.createElement("option");r.value=a[0],r.textContent=a[1],void 0!=r.textContent&&""!=r.textContent.trim()&&n.appendChild(r)}}return n}function populateSelect(e,t,n,o,a){var r=null;void 0!=e.Response[t+"TableArray"]&&(r=[].concat(e.Response[t+"TableArray"][t+"ArrayItem"]));var i=populateSelectItems(r,n);void 0!=a?$(i).selectedIndex=a:$(i).selectedIndex=0,$(i).selectmenu(),$(i).selectmenu("refresh"),$(i).change(o)}function createSelect(e,t,n,o){if(null!=$("#"+t)){var a=getInputFieldsAsQueryString(),r="/ServiceManager/Macro/ExecMacro/"+e+"?"+a+"&json=true";jQuery.getJSON(encodeURI(r),function(a){populateSelect(a,e,t,n,o)})}}function highlightText(e,t){if(e=$.trim(e),""!==e)for(var n,o,a,r=e.toLowerCase(),i=t.get(0).firstChild;(n=i.data.toLowerCase().indexOf(r))>=0;)o=i.splitText(n),i=o.splitText(r.length),a=document.createElement("span"),a.className="highlight",i.parentNode.insertBefore(a,i),a.appendChild(o)}function invokeOnSelectUserDefinedCallback(e,t){var n=window[autocomplete_config[e].itemHandler];"undefined"!=typeof n&&(/^_static_lov_/.test(autocomplete_config[e].webService)?n(t):fetchService(e,function(e){if("undefined"!=typeof e){var o=e.data.useLabelsAsKeys;n(t,o),validateRequiredFields()}else onSuggestionsError()},onSuggestionsError))}function setAutocomplete(e,t,n){var o=autocomplete_config[e],a=$("#"+o.elementId);if("DIV"===a[0].nodeName&&(a=$(a[0].parentElement)),a.autocomplete({source:t,minLength:0,selectFirst:!0,select:function(e,t){return invokeOnSelectUserDefinedCallback(o.webService,t.item.item),!1}}).click(function(){$(this).autocomplete("search",$(this).val())}).data("ui-autocomplete")._renderItem=function(e,t){var n=$("<a></a>").text(t.label);return highlightText(this.term,n),$("<li></li>").append(n).appendTo(e)},!n&&t.length>0){var a=$("#"+autocomplete_config[e].elementId);a.autocomplete("search",a.val())}}function prepareAutocompleteRequestParams(e){var t=window[autocomplete_config[e].requestPreparer];if("undefined"!=typeof t){var n=t(),o=[];for(var a in n)n.hasOwnProperty(a)&&o.push(a+"="+n[a]);return o.join("&")}return""}function presentAutocompleteItems(e,t){var n=window[autocomplete_config[e].itemPresenter];"undefined"!=typeof n&&fetchService(e,function(o){if("undefined"!=typeof o){for(var a=o.data.useLabelsAsKeys,r=[],i=0;i<t.length;i++)r.push({label:n(t[i],a),item:t[i]});setAutocomplete(e,r)}else onSuggestionsError()},onSuggestionsError)}function onSuggestionsSuccess(e,t,n){console.log("Received "+n.length+" autocomplete suggesstions from service "+t),presentAutocompleteItems(t,n),suggestions_in_progress.splice(suggestions_in_progress.indexOf(t),1),stopSmallSpinner()}function onSuggestionsError(e,t){var n=getResponseNodeValueByName("Error");void 0!=n&&n.length>0&&setTimeout(function(){showServiceErrorsPopup(n,200)},1e3),suggestions_in_progress.splice(suggestions_in_progress.indexOf(t),1),stopSmallSpinner()}function getSuggestions(e,t){return suggestions_in_progress.indexOf(t)!=-1?void console.log("Aborting: getSuggestions is already in progress!"):(startSmallSpinner("Loading suggestions.."),suggestions_in_progress.push(t),callWebService(t,prepareAutocompleteRequestParams(t),void 0,onSuggestionsSuccess,onSuggestionsError,!0,!1),void spinner().stop())}function initAutocompleteFocusTrigeer(e,t){var n=function(){fired_suggestions.indexOf(t)==-1&&(getSuggestions(e,t),fired_suggestions.push(t))},o=$("#"+e);"DIV"===o[0].nodeName?$($("#"+e)[0].parentElement).click(n):$("#"+e).focusin(n)}function initAutocompleteButton(e,t){$("#"+e).click(function(){getSuggestions(e,t),setAutocomplete(t,[])})}function prepareMobileLOV(e){var t=""===e.webService;if(t&&(e.webService="_static_lov_"+e.elementId),autocomplete_config[e.webService]=e,t){var n="convert_"+e.elementId;"function"==typeof window[n]?setAutocomplete(e.webService,window[n](),!0):console.error("No converter seed function found for static lov: "+id)}else initAutocompleteFocusTrigeer(e.elementId,e.webService),initAutocompleteButton(e.triggerId,e.webService)}function initMap(){map=new google.maps.Map(document.getElementById("map"),{center:{lat:40.7115648,lng:-74.0038266},zoom:12,gestureHandling:"cooperative",fullscreenControl:!1,streetViewControl:!1}),geocoder=new google.maps.Geocoder;var e=generateAddress();e&&0!=e.length||(e=defaultValues.Map.value,document.getElementById("map_address").innerHTML=e),geocodeAddress(e),document.getElementById("map_navigate_button").addEventListener("click",function(){var e=document.getElementById("map_address").innerHTML,t="https://www.google.com/maps/search/?api=1&query="+e.replace(" ","+");window.open(t,"_blank")}),document.getElementById("map_locate_button").addEventListener("click",function(){geocodeAddress(generateAddress(),!0)})}function generateAddress(){var e=window.convert_map();return document.getElementById("map_address").innerHTML=e,e.trim()}function geocodeAddress(e,t){void 0!==marker&&marker.setMap(null),e&&0!=e.length&&geocoder.geocode({address:e},function(e,n){"OK"===n?(map.setCenter(e[0].geometry.location),marker=new google.maps.Marker({map:map,position:e[0].geometry.location})):t&&showInfoPopup("Map","Unable to resolve address: "+n)})}function checkOfflineSupport(){"undefined"==typeof Storage&&showInfoPopup("Offline Support","LocalStorage is not supported by your browser, offline capabilities malfunction.")}function getOfflineConfig(e){for(var t="undefined"!=typeof offlineConfig&&offlineConfig instanceof Array?offlineConfig:[],n=0;n<t.length;n++)if(t[n].service===e)return t[n];return{}}function invokeOfflineHandler(e,t,n){var o=getOfflineConfig(e);switch(o.action){case"ERROR":showInfoPopup("Offline","Please try again later.");break;case"SYNC_LATER":storeOfflineRequest(getPageName(),e,t,n);break;case"STORAGE_THEN_LIVE":break;case"LIVE_THEN_STORAGE":}}function getPageName(){var e=window.location.pathname.split("/").pop();return e.indexOf("#")!==-1?e=e.substring(0,e.indexOf("#")):e}function syncOfflineRequest(e){alert("syncOfflineRequest"+e)}function syncAllOfflineRequests(){alert("syncAllOfflineRequests")}function getFirstOfflineReqIndex(){var e=localStorage.offlineReq_start;return void 0!==e?+e:0}function getLastOfflineReqIndex(){var e=localStorage.offlineReq_end;return void 0!==e?+e:-1}function storeOfflineRequest(e,t,n,o){var a=getLastOfflineReqIndex()+1,r=new Date;localStorage["offlineReq_"+a+"_page"]=e,localStorage["offlineReq_"+a+"_service"]=t,localStorage["offlineReq_"+a+"_time"]=r.toLocaleDateString()+" "+r.toLocaleTimeString(),localStorage["offlineReq_"+a+"_url"]=n,localStorage["offlineReq_"+a+"_query"]=o,localStorage.offlineReq_end=a,showInfoPopup("Offline","Your action will be synced later.")}function deleteOfflineRequest(e){localStorage.removeItem("offlineReq_"+e+"_page"),localStorage.removeItem("offlineReq_"+e+"_service"),localStorage.removeItem("offlineReq_"+e+"_time"),localStorage.removeItem("offlineReq_"+e+"_url"),localStorage.removeItem("offlineReq_"+e+"_query")}function getOfflineRequests(){for(var e=[],t=getFirstOfflineReqIndex(),n=getLastOfflineReqIndex(),o=t;o<n+1;o++)void 0!==localStorage["offlineReq_"+o+"_service"]&&e.push({index:o,page:localStorage["offlineReq_"+o+"_page"],service:localStorage["offlineReq_"+o+"_service"],time:localStorage["offlineReq_"+o+"_time"],url:localStorage["offlineReq_"+o+"_url"],query:localStorage["offlineReq_"+o+"_query"]});return showHideOfflineRequestsTable(e),e}function storeOfflineResponseIfNeeded(e,t){var n=getOfflineConfig(e).action;"STORAGE_THEN_LIVE"!==n&&"LIVE_THEN_STORAGE"!==n||(localStorage["offlineRes_"+e]=JSON.stringify(t))}function showHideOfflineRequestsTable(e){0!==e.length?(document.getElementById("offlineRequestsContainer").style.display="block",document.getElementById("noOfflineRequestsContainer").style.display="none"):(document.getElementById("offlineRequestsContainer").style.display="none",document.getElementById("noOfflineRequestsContainer").style.display="block")}function populateOfflineRequestsTable(e){offlineRequestsTableData=e;var t=document.getElementById("offlineRequestsTbody");if(null!==t){for(;t.rows.length>0;)t.deleteRow(0);for(var n=0;n<e.length;n++){var o,a=t.insertRow(n);o=document.createElement("td"),a.appendChild(o),o.innerHTML=e[n].index,o=a.insertCell(-1),o.innerHTML=e[n].page,o=a.insertCell(-1),o.innerHTML=e[n].service,o=a.insertCell(-1),o.innerHTML=e[n].time,o=a.insertCell(-1),o.innerHTML='<a title="Sync" href="#" onclick="syncOfflineRequest('+n+')"\r\nclass="ui-btn ui-corner-all ui-shadow ui-btn-inline ui-icon-refresh ui-btn-icon-notext"\r\nstyle="width: 40px !important; margin-right: 10px"></a>\r\n<a title="Delete" href="#" onclick="deleteTableOfflineRequest('+n+')"\r\nclass="ui-btn ui-corner-all ui-shadow ui-btn-inline ui-icon-minus ui-btn-icon-notext"\r\nstyle="width: 40px !important; margin-right: 0"></a>'}}}function deleteTableOfflineRequest(e){var t=offlineRequestsTableData[e];showConfirmPopup("Delete sync request #"+t.index,"Are you sure you want to delete request for service "+t.service+" made from "+t.page+"?",function(){offlineRequestsTableData.splice(e,1),document.getElementById("offlineRequestsTbody").deleteRow(e),deleteOfflineRequest(t.index)})}function showInfoPopup(e,t,n){$("#infoPopupTitle").text(e),$("#infoPopupMessage").html(t),$("#infoPopup").popup({afterclose:function(e,t){"undefined"!=typeof n&&n()}}),setTimeout(function(){$("#infoPopup").popup("open")},200)}function showConfirmPopup(e,t,n,o){$("#confirmPopupTitle").text(e),$("#confirmPopupMessage").text(t),confirmPopupConfirmCallback=n,confirmPopupCancelCallback=o,setTimeout(function(){$("#confirmPopup").popup("open")},200)}function spinner(e){return androidSpinner}function startSmallSpinner(e){$("#mainBody").append('<div id="small-spinner" class="ui-loader ui-corner-all ui-body-z ui-loader-verbose small-spinner"><span class="ui-icon-loading"><h1>'+e+"</h1></span></div>")}function stopSmallSpinner(){var e=document.getElementById("small-spinner");void 0!=e&&e.remove()}function saveInputFieldsToServer(){"use strict";$.ajax({url:getServiceManagerHost()+"/ServiceManager/Macro/UserData/"+userDataId,type:"PUT",contentType:"application/json",async:!1,dataType:"text",data:getInputFieldsAsJson(),success:function(){},error:function(){}})}function getUserDataFromServer(){"use strict";$.ajax({url:getServiceManagerHost()+"/ServiceManager/Macro/UserData/"+userDataId,async:!1,dataType:"text",cache:!1,success:function(e){try{try{e=e}catch(t){}data=JSON.parse(e).data}catch(t){data=new Object}setUserDataValuesInFields()}})}function saveUserData(){"use strict";useSessionStorage?updateSessionDataFromHTML(collectInputElements()):saveInputFieldsToServer()}function clearUserData(){if(useSessionStorage)sessionStorage.clear();else for(item in data)data[item]="null"}function updateSessionDataFromHTML(e){"use strict";for(var t=0;t<e.length;t++){var n=e[t],o=n.id;if(null!=o&&0!=o.length){var a="checkbox"===n.type?n.checked:n.value;useSessionStorage&&sessionStorage.setItem(o,a)}}}function store(e,t){useSessionStorage?sessionStorage.setItem(e,t):data[e]=t}function storeFromIndex(e,t){var n=e.substr(0,getNameWoIndexLength(e))+"_"+t,o=getSessionFieldValue(n);store(e,o)}function clearArrayKeysInSessionStorage(e){for(var t in e[0]){removeItem(t);for(var n=t.substr(0,getNameWoIndexLength(t)),o=0,t=n+"_0";0===o||containsKey(t);)removeItem(t),o++,t=n+"_"+o}}function storeArrayInSessionStorage(e){if(null!=e&&isArray(e)){clearArrayKeysInSessionStorage(e);for(var t=0;t<e.length;t++){var n=e[t];if(void 0!=n)for(var o in n){var a=o.substr(0,getNameWoIndexLength(o))+"_"+t;data[a]=n[o],1==useSessionStorage&&sessionStorage.setItem(a,n[o]),0!==t||/_0$/.test(o)||(data[o]=n[o],1==useSessionStorage&&sessionStorage.setItem(o,n[o]))}}}}function containsKey(e){return useSessionStorage?null!==sessionStorage.getItem(e):e in data}function getSessionFieldValue(e,t){var n="";try{n=useSessionStorage?sessionStorage.getItem(e):data[e]}catch(o){}return t===!1?n:cleanValue(n)}function removeItem(e){useSessionStorage?sessionStorage.removeItem(e):data[e]=null}function removeItemNameContains(e){if(useSessionStorage)for(var t in sessionStorage)t.indexOf(e)>=0&&sessionStorage.removeItem(t)}function getHighestIndex(e){var t=-1,n=e.substr(0,getNameWoIndexLength(e));for(var o in sessionStorage){var a=o.substr(0,getNameWoIndexLength(o));if(a===n){var r=+o.substr(o.lastIndexOf("_")+1);r>t&&(t=r)}}return t}function executeTableOnClickHandlers(e,t,n){var o=[];$.merge(o,getHandlersByFilter(handlerMap,{action:"tableClick:webservice"})),$.merge(o,getHandlersByFilter(handlerMap,{action:"tableClick:navigate"})),$.merge(o,getHandlersByFilter(handlerMap,{action:"tableClick:function"}));for(var a=0;a<o.length;a++)executeHandler(o[a],e,t,n)}function formatTableValue(e,t){return e&&e.indexOf("%s")!==-1?e.replace("%s",t):t}function populateTableOrList(){hasTable?populateTable(tableOutputBody):hasList&&populateTableListLayout(listOutput)}function initTableOrListFlags(){tableOutputBody=document.getElementById("tableOutputBody"),listOutput=document.getElementById("listOutput"),hasTable=null!=tableOutputBody,hasList=null!=listOutput}function addTableOrListClickListener(){hasTable?addTableClickListener():hasList&&addTableListLayoutClickListener()}function getListColumnsMetadata(){var e=document.getElementById("listOutputHead");if(null==e)return null;for(var t=[],n=e.getElementsByTagName("div"),o=0;o<n.length;o++)t.push({id:n[o].id,displayFormat:n[o].getAttribute("display-format")});return t}function populateTableListLayoutRow(e,t,n){var o="";for(var a in t){var r=t[a].id,i=r.substr(0,getNameWoIndexLength(r))+"_"+n,s=formatTableValue(t[a].displayFormat,sessionStorage[i]),l=String.fromCharCode("a".charCodeAt(0)+ +a%2);o+="<div"+(+a>=2?' style="font-weight:normal"':"")+' class="ui-block-'+l+'">\n\t'+s+"\n</div>\n"}var u=1==t.length?"ui-grid-solo":"ui-grid-a";e.innerHTML+='<li><a href="#" class="ui-btn ui-btn-icon-right ui-icon-carat-r">\n\t<div class="'+u+'">\n\t\t'+o+"\t\n</div>\n</a></li>"}function clearAllTableListLayoutRows(){if(null!=listOutput)for(var e=listOutput.childElementCount-1,t=0;t<e;t++)listOutput.removeChild(listOutput.lastElementChild)}function populateTableListLayout(e){if(null!=e){var t=getListColumnsMetadata();if(null!=t){clearAllTableListLayoutRows();for(var n=getHighestIndex(t[0].id),o=0;o<=n;o++)populateTableListLayoutRow(e,t,o)}}}function calculateIndexInParent(e){for(var t=0;null!=(e=e.previousElementSibling);)t++;return t}function addTableListLayoutClickListener(){$("#listOutput").on("click","li",function(e){for(var t=calculateIndexInParent(e.currentTarget)-1,n=0,o=[],a=e.currentTarget.children[0].children[0].children,r=0;r<a.length;r++)o.push(a[r].innerText);executeTableOnClickHandlers(t,n,o)})}function getTableColumnsMetadata(){var e=document.getElementById("tableOutputHead");if(null==e)return null;for(var t=[],n=e.getElementsByTagName("th"),o=0;o<n.length;o++)t.push({id:n[o].id,displayFormat:n[o].getAttribute("display-format")});return t}function populateTableRow(e,t,n){var o=e.rows.length,a=e.insertRow(o);for(var r in t){
var i,s=t[r].id,l=s.substr(0,getNameWoIndexLength(s))+"_"+n,u=formatTableValue(t[r].displayFormat,sessionStorage[l]);0==a.cells.length?(i=document.createElement("td"),a.appendChild(i)):i=a.insertCell(-1),i.innerHTML=u}}function populateTable(e){if(null!=e){var t=getTableColumnsMetadata();if(null!=t){clearAllTableRows();for(var n=getHighestIndex(t[0].id),o=0;o<=n;o++)populateTableRow(e,t,o)}}}function clearAllTableRows(){if(null!=tableOutputBody)for(;tableOutputBody.rows.length>0;)tableOutputBody.deleteRow(0)}function addTableClickListener(){$("#tableOutput").on("click","td",function(e){for(var t=e.currentTarget.parentElement.rowIndex-1,n=e.currentTarget.cellIndex,o=[],a=e.currentTarget.parentElement.cells,r=0;r<a.length;r++)o.push(a[r].innerText);executeTableOnClickHandlers(t,n,o)})}function isEmpty(e){return!e||0===e.length}function isArray(e){return void 0!=e&&"[object Array]"===Object.prototype.toString.call(e)}function isFunction(e){var t={};return e&&"[object Function]"===t.toString.call(e)}function setValues(e,t,n){return setValuesHelper(e,t,n)}function setValuesHelper(e,t,n){if(e)if(e instanceof Array)for(var o in e)setValuesHelper(e[o],t,n);else if(e[t]&&(e[t]=n),"object"==typeof e&&null!==e){var a=Object.keys(e);if(a.length>0)for(o=0;o<a.length;o++)setValuesHelper(e[a[o]],t,n)}}function findValues(e,t){return findValuesHelper(e,t,[])}function findValuesHelper(e,t,n){if(!e)return n;if(e instanceof Array){for(var o in e)n=n.concat(findValuesHelper(e[o],t,[]));return n}if(e[t]&&n.push(e[t]),"object"==typeof e&&null!==e){var a=Object.keys(e);if(a.length>0)for(o=0;o<a.length;o++)n=n.concat(findValuesHelper(e[a[o]],t,[]))}return n}function cleanValue(e){switch(typeof e){case"string":return e.trim();case"boolean":case"number":return e;default:return""}}var docCookies={getItem:function(e){return decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"))||null},setItem:function(e,t,n,o,a,r){if(!e||/^(?:expires|max\-age|path|domain|secure)$/i.test(e))return!1;var i="";if(n)switch(n.constructor){case Number:i=n===1/0?"; expires=Fri, 31 Dec 9999 23:59:59 GMT":"; max-age="+n;break;case String:i="; expires="+n;break;case Date:i="; expires="+n.toUTCString()}return document.cookie=encodeURIComponent(e)+"="+encodeURIComponent(t)+i+(a?"; domain="+a:"")+(o?"; path="+o:"")+(r?"; secure":""),!0},removeItem:function(e,t,n){return!(!e||!this.hasItem(e))&&(document.cookie=encodeURIComponent(e)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT"+(n?"; domain="+n:"")+(t?"; path="+t:""),!0)},hasItem:function(e){return new RegExp("(?:^|;\\s*)"+encodeURIComponent(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=").test(document.cookie)},keys:function(){for(var e=document.cookie.replace(/((?:^|\s*;)[^\=]+)(?=;|$)|^\s*|\s*(?:\=[^;]*)?(?:\1|$)/g,"").split(/\s*(?:\=[^;]*)?;\s*/),t=0;t<e.length;t++)e[t]=decodeURIComponent(e[t]);return e}},inputElementsArray=null;"undefined"==typeof jQuery.when.all&&(jQuery.when.all=function(e){return $.Deferred(function(t){$.when.apply(jQuery,e).then(function(){t.resolveWith(this,[Array.prototype.slice.call(arguments)])},function(){t.rejectWith(this,[Array.prototype.slice.call(arguments)])})})}),$(document).ready(function(){$("input[type=file]").click(function(){$(this).val(""),document.getElementById(this.id+"_filename").innerHTML="(No file)"}),$("input[type=file]").change(function(){this.setAttribute("uploaded",!1),this.removeAttribute("fileFromCamera"),document.getElementById(this.id+"_filename").innerHTML=this.files[0].name})});var showStatusMessages=!1,WEB_SERVICE_TIMEOUT=3e4,waitingForResponse=!1,useSessionStorage=!0,handlerMap,userDataId,cookieLifespan=3600,data={};window.lastFocusedElement=null;var showErrorInRequest=!0;$(function(){$("input[type='button']").on("click",function(){for(var e=$(this).attr("id"),t=getHandlersByFilter(handlerMap,{element:e}),n=0;n<t.length;n++)executeHandler(t[n])}),$("button").on("click",function(){for(var e=$(this).attr("id"),t=getHandlersByFilter(handlerMap,{element:e}),n=0;n<t.length;n++)executeHandler(t[n])}),$(document).keydown(function(e){var t=e.which;window.lastFocusedElement=e.target;for(var n=e.target.id,o=getHandlersByFilter(handlerMap,{key:t}),a=0;a<o.length;a++)void 0==o[a].element||""==o[a].element?executeHandler(o[a]):o[a].element==n&&executeHandler(o[a]);if(13===t)return event.preventDefault(),!1})}),$(window).load(function(){$("body").show()});var autocomplete_config={},fired_suggestions=[],suggestions_in_progress=[],map,geocoder,marker,offlineRequestsTableData,confirmPopupConfirmCallback=void 0,confirmPopupCancelCallback=void 0;$(function(){$("#confirmPopupOk").on("click",function(){void 0!=confirmPopupConfirmCallback&&confirmPopupConfirmCallback()}),$("#confirmPopupCancel").on("click",function(){void 0!=confirmPopupCancelCallback&&confirmPopupCancelCallback()})});var androidSpinner=function(){"use strict";var e={};return e.start=function(e,t){$.mobile.loading("show",{text:e,textVisible:!0,theme:"b"===t?t:"z",html:""})},e.stop=function(){$.mobile.loading("hide")},e}(),hasTable,hasList,tableOutputBody,listOutput;
//# sourceMappingURL=auraplayer.js.map
